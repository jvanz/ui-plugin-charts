(("undefined"!==typeof self?self:this)["webpackJsonpkubewarden_2_0_0"]=("undefined"!==typeof self?self:this)["webpackJsonpkubewarden_2_0_0"]||[]).push([[0],{"00ce":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._t("traceBanner"),e.rows?a("SortableTable",{attrs:{rows:e.rows,headers:e.TRACE_HEADERS,"table-actions":!1,"row-actions":!1,"key-field":"traceID","default-sort-by":"startTime","sub-expandable":!0,"sub-expand-column":!0,"sub-rows":!0,paging:!0,"rows-per-page":e.rowsPerPage},scopedSlots:e._u([{key:"col:mode",fn:function(t){var r=t.row;return[a("td",[a("BadgeState",{attrs:{label:e.capitalizeMessage(r.mode),color:e.modeColor(r.mode)}})],1)]}},{key:"col:operation",fn:function(t){var r=t.row;return[a("td",[e._v(" "+e._s(r.operation)+" ")])]}},{key:"sub-row",fn:function(t){var r=t.row,s=t.fullColspan;return[a("td",{staticClass:"sub-row",attrs:{colspan:s}},[a("div",{staticClass:"details"},[e.showLogs(r.logs)?[a("section",{staticClass:"col"},[a("div",{staticClass:"title"},[e._v(" Response ")]),r.logs.response?a("span",{staticClass:"text-info"},[e._v(" "+e._s(e.capitalizeMessage(r.logs.response))+" ")]):a("span",[e._v(" N/A ")])])]:[a("section",{staticClass:"col"},[a("div",{staticClass:"title"},[e._v(" Response Message ")]),r.response_message?a("span",{staticClass:"text-warning"},[e._v(" "+e._s(e.capitalizeMessage(r.response_message))+" ")]):a("span",[e._v(" N/A ")])]),a("section",{staticClass:"col"},[a("div",{staticClass:"title"},[e._v(" Response Code ")]),a("span",{staticClass:"text-info"},[e._v(" "+e._s(r.response_code?r.response_code:"N/A")+" ")])]),a("section",{staticClass:"col"},[a("div",{staticClass:"title"},[e._v(" Mutated ")]),a("span",{staticClass:"text-info"},[e._v(" "+e._s(r.mutated)+" ")])])]],2)])]}}],null,!1,866474010)}):e._e()],2)},s=[],i=a("e24b"),o=a("f17a"),n=a("0fb1"),l=a("d892"),c=a("5191"),d=a("90cd"),u={props:{rows:{type:Array,default:()=>[]}},components:{BadgeState:o["a"],SortableTable:n["b"]},data(){return{MODE_MAP:l["c"],TRACE_HEADERS:c["f"],OPERATION_MAP:l["e"]}},computed:{groupField(){return this.isPolicyServer?"policy_id":null},isPolicyServer(){return this.$route.params.resource===d["a"].POLICY_SERVER},rowsPerPage(){return this.isPolicyServer?40:20}},methods:{capitalizeMessage(e){return(null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))},modeColor(e){return this.MODE_MAP[e]},opColor(e){return this.OPERATION_MAP[e]},showLogs(e){return!Object(i["h"])(e)}}},p=u,b=(a("d360"),a("d802")),v=Object(b["a"])(p,r,s,!1,null,"490704fe",null);t["a"]=v.exports},"0a5c":function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,'.clearfix[data-v-69b91d8b]:after,.clearfix[data-v-69b91d8b]:before{content:" ";display:table}.clearfix[data-v-69b91d8b]:after{clear:both}.list-unstyled[data-v-69b91d8b]{margin:0;padding:0;list-style-type:none}.no-select[data-v-69b91d8b]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-69b91d8b]{resize:none}.hand[data-v-69b91d8b]{cursor:pointer;cursor:hand}.fixed[data-v-69b91d8b]{table-layout:fixed}.clip[data-v-69b91d8b]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-69b91d8b],.force-wrap[data-v-69b91d8b]{word-wrap:break-word}.force-wrap[data-v-69b91d8b]{white-space:normal}.bordered-section[data-v-69b91d8b]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-69b91d8b]{margin-bottom:20px;margin-top:20px}.policy__mode[data-v-69b91d8b]{display:flex;align-items:center}.policy__mode i[data-v-69b91d8b]{margin-left:5px;font-size:22px;color:var(--warning)}.gauges[data-v-69b91d8b],.gaugesContainer[data-v-69b91d8b]{display:flex}.gauges[data-v-69b91d8b]{justify-content:space-around;flex-wrap:wrap;justify-content:left}.gauges .count-gauge[data-v-69b91d8b]{width:46%;margin-bottom:10px;flex:initial}.gauges>*[data-v-69b91d8b]{flex:1;margin-right:1.75%}',""]),e.exports=t},"284d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.$fetchState.pending?a("Loading"):a("div",[e.policyGauges?[a("div",{staticClass:"row"},[[a("div",{staticClass:"col span-6"},[a("h3",[e._v(" "+e._s(e.t("kubewarden.policyServer.policyGauge.byStatus"))+" ")]),a("div",{staticClass:"gauges mb-20"},e._l(e.policyGauges,(function(t,r){return a("CountGauge",{key:r,attrs:{total:e.relatedPoliciesTotal,useful:t.count||0,graphical:!1,"primary-color-var":"--sizzle-"+t.color,name:r}})})),1)])],e.emptyTraces?e._e():[a("div",{staticClass:"col span-6"},[a("h3",[e._v(" "+e._s(e.t("kubewarden.policyServer.policyGauge.traces"))+" ")]),a("div",{staticClass:"gauges mb-20"},e._l(e.tracesGauges,(function(t,r){return a("CountGauge",{key:r,attrs:{total:e.filteredValidations.length,useful:t.count||0,graphical:!1,"primary-color-var":"--sizzle-"+t.color,name:r}})})),1)])]],2)]:e._e(),a("ResourceTabs",{attrs:{mode:e.mode},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("Tab",{attrs:{name:"related-policies",label:"Policies",weight:99},scopedSlots:e._u([{key:"default",fn:function(){return[a("ResourceTable",{attrs:{rows:e.relatedPolicies||[],headers:e.RELATED_HEADERS,groupable:!0,"group-by":"kind","table-actions":!0},scopedSlots:e._u([{key:"col:operation",fn:function(t){var r=t.row;return[a("td",[a("BadgeState",{attrs:{label:r.operation,color:e.color(r.operation)}})],1)]}}])})]},proxy:!0}])}),a("Tab",{attrs:{name:"policy-metrics",label:"Metrics",weight:98},scopedSlots:e._u([e.metricsService?{key:"default",fn:function(t){return[t.active?a("DashboardMetrics",{attrs:{"detail-url":e.metricsProxy,"summary-url":e.metricsProxy,"graph-height":"825px"}}):e._e()]}}:null],null,!0)},[e.monitoringStatus.installed&&e.metricsService?e._e():a("MetricsBanner",{attrs:{"metrics-service":e.metricsService,"metrics-type":e.metricsType,"monitoring-route":e.monitoringRoute,"reload-required":e.reloadRequired},on:{add:e.addDashboard}})],1),a("Tab",{attrs:{name:"policy-tracing",label:"Tracing",weight:97}},[[a("TraceTable",{attrs:{rows:e.filteredValidations},scopedSlots:e._u([{key:"traceBanner",fn:function(){return[e.emptyTraces?a("Banner",{attrs:{color:"warning"}},[e.jaegerService?a("span",[e._v(e._s(e.t("kubewarden.tracing.noRelatedTraces")))]):a("span",{domProps:{innerHTML:e._s(e.t("kubewarden.tracing.noJaeger",{},!0))}})]):e._e()]},proxy:!0}])})]],2)],1)],2)},s=[],i=a("9ce4"),o=a("da25"),n=a("f390"),l=a("b45b"),c=a("a8b9"),d=a("305c"),u=a("6418"),p=a("74c2"),b=a("c389"),v=a("15ca"),m=a("c422"),f=a("126f"),h=a("38de"),g=a("9ec3"),y=a("90cd"),_=a("5191"),w=a("2c30"),S=a("00ce"),x={name:"PolicyServer",components:{Banner:u["a"],CountGauge:p["a"],DashboardMetrics:b["a"],Loading:v["a"],MetricsBanner:w["a"],ResourceTabs:m["a"],ResourceTable:f["a"],Tab:h["a"],TraceTable:S["a"]},mixins:[d["a"]],props:{mode:{type:String,default:o["p"]},value:{type:Object,required:!0}},async fetch(){const e=await Object(c["a"])({relatedPolicies:this.value.allRelatedPolicies(),policyGauges:this.value.policyGauges(),jaegerService:this.value.jaegerService()});if(Object(g["isEmpty"])(e.relatedPolicies)||(this.relatedPolicies=e.relatedPolicies),Object(g["isEmpty"])(e.policyGauges)||(this.policyGauges=e.policyGauges),Object(g["isEmpty"])(e.jaegerService)||(this.jaegerService=e.jaegerService),!Object(g["isEmpty"])(this.relatedPolicies)&&this.jaegerService&&(this.filteredValidations=await this.value.filteredValidations({service:this.jaegerService})),this.monitoringStatus.installed)try{var t;if(this.metricsProxy=await this.value.grafanaProxy(this.metricsType),this.metricsProxy)this.metricsService=await Object(l["b"])(this.$store,null===(t=this.currentCluster)||void 0===t?void 0:t.id,this.metricsProxy)}catch(r){console.error("Error fetching Grafana service: "+r)}else{await this.$store.dispatch("catalog/load");const e=this.$store.getters["catalog/rawCharts"],t=Object.values(e),r=t.find(e=>"rancher-monitoring"===e.chartName);var a;if(r)this.monitoringRoute={name:"c-cluster-apps-charts-install",params:{cluster:this.$route.params.cluster,product:this.$store.getters["productId"]},query:{[o["g"]]:"cluster",[o["f"]]:"rancher-charts",[o["c"]]:"rancher-monitoring",[o["m"]]:null===(a=r.versions[0])||void 0===a?void 0:a.version}}}},data(){return{RELATED_HEADERS:_["d"],jaegerService:null,filteredValidations:null,metricsProxy:null,metricsService:null,monitoringRoute:null,policyGauges:null,relatedPolicies:null,reloadRequired:!1,metricsType:y["g"].POLICY_SERVER}},computed:{...Object(i["a"])(["currentCluster","currentProduct"]),...Object(n["c"])(),emptyTraces(){return Object(g["isEmpty"])(this.filteredValidations)},relatedPoliciesTotal(){return Object(g["isEmpty"])(this.relatedPolicies)?0:this.relatedPolicies.length},tracesGauges(){return this.emptyTraces?null:this.value.tracesGauges(this.filteredValidations)}},methods:{async addDashboard(e){try{await this.value.addGrafanaDashboard(this.metricsType),e(!0),this.reloadRequired=!0}catch(t){this.errors=t,e(!1)}},hasNamespaceSelector(e){return e.namespaceSelector}}},T=x,P=(a("41d4"),a("d802")),R=Object(P["a"])(T,r,s,!1,null,"69b91d8b",null);t["default"]=R.exports},"2c30":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.monitoringStatus.installed?e.metricsDashboard?e.metricsService?e._e():a("div",[a("Banner",{attrs:{color:"error"}},[a("i",{staticClass:"icon icon-checkmark mr-10"}),a("span",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.noService"))+" ")])])],1):a("div",[a("Banner",{attrs:{color:"warning"}},[e.reloadRequired?[a("i",{staticClass:"icon icon-checkmark mr-10"}),a("span",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.reload"))+" ")]),a("button",{staticClass:"ml-10 btn btn-sm role-primary",on:{click:function(t){return e.reload()}}},[e._v(" "+e._s(e.t("generic.reload"))+" ")])]:[a("p",{staticClass:"mb-20"},[e._v(" "+e._s(e.t("kubewarden.metrics.notInstalled"))+" ")]),a("AsyncButton",{attrs:{mode:"grafanaDashboard"},on:{click:function(t){return e.$emit("add",t)}}})]],2)],1):a("div",[a("Banner",{attrs:{color:"warning"}},[a("span",{domProps:{innerHTML:e._s(e.t("kubewarden.monitoring.notInstalled",{},!0))}}),a("button",{staticClass:"btn role-primary ml-10",on:{click:function(t){return t.preventDefault(),e.chartRoute.apply(null,arguments)}}},[e._v(" "+e._s(e.t("kubewarden.policyServer.noDefaultsInstalled.button"))+" ")])])],1)},s=[],i=a("9ce4"),o=a("f390"),n=a("907c"),l=a("6418"),c=a("d709"),d={name:"MetricsBanner",props:{metricsService:{type:[Boolean,Object],default:null},metricsType:{type:String,required:!0},reloadRequired:{type:Boolean,default:!1}},components:{AsyncButton:c["b"],Banner:l["a"]},async fetch(){this.monitoringChart||await this.$store.dispatch("catalog/load"),await this.$store.dispatch("cluster/findAll",{type:n["c"]})},computed:{...Object(i["a"])(["currentProduct"]),...Object(o["c"])(),monitoringChart(){return this.$store.getters["catalog/chart"]({chartName:"rancher-monitoring"})},metricsDashboard(){const e=this.$store.getters["cluster/matching"]({type:n["c"],selector:"kubewarden/part-of=cattle-kubewarden-system"});return Array.isArray(e)&&!e.length?null:e}},methods:{reload(){this.$router.go()},chartRoute(){var e;null===(e=this.monitoringChart)||void 0===e||e.goToInstall()}}},u=d,p=a("d802"),b=Object(p["a"])(u,r,s,!1,null,null,null);t["a"]=b.exports},"41d4":function(e,t,a){"use strict";a("d572")},"733f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PolicyDetail",{attrs:{value:e.value,mode:e.mode,resource:e.resource}})},s=[],i=a("da25"),o=a("80db"),n={name:"AdmissionPolicy",props:{mode:{type:String,default:i["p"]},resource:{type:String,default:null},value:{type:Object,required:!0}},components:{PolicyDetail:o["a"]}},l=n,c=a("d802"),d=Object(c["a"])(l,r,s,!1,null,null,null);t["default"]=d.exports},"80db":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.$fetchState.pending?a("Loading"):a("div",[a("div",{staticClass:"mb-20"},[a("h3",[e._v(e._s(e.t("namespace.resources")))])]),a("ResourceTabs",{attrs:{mode:e.mode,"need-related":e.hasRelationships},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[e.hasRules?a("Tab",{attrs:{name:"policy-rules",label:"Rules",weight:99}},[a("RulesTable",{attrs:{rows:e.rulesRows}})],1):e._e(),a("Tab",{attrs:{name:"policy-tracing",label:"Tracing",weight:98}},[a("TraceTable",{attrs:{rows:e.tracesRows},scopedSlots:e._u([{key:"traceBanner",fn:function(){return[e.emptyTraces?a("Banner",{attrs:{color:"warning"}},[e.jaegerService?a("span",[e._v(e._s(e.t("kubewarden.tracing.noTraces")))]):a("span",{domProps:{innerHTML:e._s(e.t("kubewarden.tracing.noJaeger",{},!0))}})]):e._e()]},proxy:!0}])})],1),a("Tab",{attrs:{name:"policy-metrics",label:"Metrics",weight:97},scopedSlots:e._u([e.metricsService?{key:"default",fn:function(t){return[t.active?a("DashboardMetrics",{attrs:{"detail-url":e.metricsProxy,"summary-url":e.metricsProxy,vars:e.dashboardVars,"graph-height":"825px"}}):e._e()]}}:null],null,!0)},[e.monitoringStatus.installed&&e.metricsService?e._e():a("MetricsBanner",{attrs:{"metrics-service":e.metricsService,"metrics-type":e.metricsType,"reload-required":e.reloadRequired},on:{add:e.addDashboard}})],1)],1)],1)},s=[],i=a("9ce4"),o=a("330a"),n=a.n(o),l=a("da25"),c=a("f390"),d=a("b45b"),u=a("305c"),p=a("6418"),b=a("c389"),v=a("15ca"),m=a("c422"),f=a("38de"),h=a("90cd"),g=a("2c30"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.rows.length>0?a("SortableTable",{attrs:{rows:e.rows,headers:e.RULE_HEADERS,"table-actions":!1,"row-actions":!1,"key-field":"traceID","default-sort-by":"startTime"},scopedSlots:e._u([{key:"col:apiGroup",fn:function(t){var r=t.row;return[a("td",[a("span",[e._v(e._s(r.apiGroups||"-"))])])]}},{key:"col:apiVersion",fn:function(t){var r=t.row;return[a("td",[a("span",[e._v(e._s(r.apiVersions||"-"))])])]}},{key:"col:operations",fn:function(t){var r=t.row;return[a("td",[a("span",[e._v(e._s(e.joinColumn(r.operations)))])])]}},{key:"col:resources",fn:function(t){var r=t.row;return[a("td",[a("span",[e._v(e._s(e.joinColumn(r.resources)))])])]}}],null,!1,1857136105)}):a("div",[a("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning",label:e.t("kubewarden.policies.noRules")}})],1)],1)},_=[],w=a("0fb1"),S=a("5191"),x={props:{rows:{type:Array,default:()=>[]}},components:{Banner:p["a"],SortableTable:w["b"]},data(){return{RULE_HEADERS:S["e"]}},methods:{joinColumn(e){return(null===e||void 0===e?void 0:e.join(", "))||""}}},T=x,P=a("d802"),R=Object(P["a"])(T,y,_,!1,null,null,null),C=R.exports,j=a("00ce"),k={name:"PolicyDetail",components:{Banner:p["a"],DashboardMetrics:b["a"],Loading:v["a"],MetricsBanner:g["a"],ResourceTabs:m["a"],RulesTable:C,Tab:f["a"],TraceTable:j["a"]},mixins:[u["a"]],props:{mode:{type:String,default:l["p"]},resource:{type:String,default:null},value:{type:Object,required:!0}},async fetch(){if(this.monitoringStatus.installed)try{var e;if(this.metricsProxy=await this.value.grafanaProxy(this.metricsType),this.metricsProxy)this.metricsService=await Object(d["b"])(this.$store,null===(e=this.currentCluster)||void 0===e?void 0:e.id,this.metricsProxy)}catch(t){console.error("Error fetching Grafana service: "+t)}this.jaegerService=await this.value.jaegerService(),this.jaegerService&&(this.filteredValidations=await this.value.jaegerSpecificValidations({service:this.jaegerService}))},data(){return{jaegerService:null,metricsProxy:null,metricsService:null,reloadRequired:!1,filteredValidations:null,metricsType:h["g"].POLICY}},computed:{...Object(i["a"])(["currentCluster"]),...Object(c["c"])(),dashboardVars(){var e;return{policy_name:"clusterwide-"+(null===(e=this.value)||void 0===e?void 0:e.id)}},emptyTraces(){return!!n()(this.filteredValidations)},hasRelationships(){var e;return!(null===(e=this.value.metadata)||void 0===e||!e.relationships)},hasRules(){return!n()(this.rulesRows[0])},rulesRows(){var e;return null===(e=this.value.spec)||void 0===e?void 0:e.rules},tracesRows(){return this.filteredValidations?this.value.traceTableRows(this.filteredValidations):[]}},methods:{async addDashboard(e){try{await this.value.addGrafanaDashboard(this.metricsType),e(!0),this.reloadRequired=!0}catch(t){this.errors=t,e(!1)}}}},E=k,O=Object(P["a"])(E,r,s,!1,null,null,null);t["a"]=O.exports},a7cb:function(e,t,a){var r=a("5eaa");t=r(!1),t.push([e.i,'.clearfix[data-v-490704fe]:after,.clearfix[data-v-490704fe]:before{content:" ";display:table}.clearfix[data-v-490704fe]:after{clear:both}.list-unstyled[data-v-490704fe]{margin:0;padding:0;list-style-type:none}.no-select[data-v-490704fe]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-490704fe]{resize:none}.hand[data-v-490704fe]{cursor:pointer;cursor:hand}.fixed[data-v-490704fe]{table-layout:fixed}.clip[data-v-490704fe]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-490704fe],.force-wrap[data-v-490704fe]{word-wrap:break-word}.force-wrap[data-v-490704fe]{white-space:normal}.bordered-section[data-v-490704fe]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-490704fe]{margin-bottom:20px;margin-top:20px}.sub-row[data-v-490704fe]{background-color:var(--body-bg);border-bottom:1px solid var(--sortable-table-top-divider);padding-left:1rem;padding-right:1rem}.details[data-v-490704fe]{display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);gap:1em}.details .col[data-v-490704fe]{display:flex;flex-direction:column}.details .col section[data-v-490704fe]{margin-bottom:1.5rem}.details .col .title[data-v-490704fe]{color:var(--muted);margin-bottom:.5rem}',""]),e.exports=t},b3e2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PolicyDetail",{attrs:{value:e.value,mode:e.mode,resource:e.resource}})},s=[],i=a("da25"),o=a("80db"),n={name:"ClusterAdmissionPolicy",props:{mode:{type:String,default:i["p"]},resource:{type:String,default:null},value:{type:Object,required:!0}},components:{PolicyDetail:o["a"]}},l=n,c=a("d802"),d=Object(c["a"])(l,r,s,!1,null,null,null);t["default"]=d.exports},d360:function(e,t,a){"use strict";a("f608")},d572:function(e,t,a){var r=a("0a5c");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("ab214dc6",r,!0,{sourceMap:!1,shadowMode:!1})},f608:function(e,t,a){var r=a("a7cb");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("0ed3").default;s("4ad7c6ba",r,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=kubewarden-2.0.0.umd.min.detail.js.map